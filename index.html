<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>丁磊邀请你参加520发布会</title>
    <link type="text/css" rel="stylesheet" href="css/animate.css" />
    <link type="text/css" rel="stylesheet" href="css/star2.css" />
    <script type='text/javascript' charset='utf8' src="js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" charset="utf8" src="js/jquery.touchwipe.js"></script>
    <script type="text/javascript" charset="utf8" src="js/jquery.bgmusic.js"></script>
    <script type="text/javascript" src="js/html2canvas.js"></script>
</head>

<body>
    <div id="app">
        <div id="pg0" style="display: block">
            <div id="pg0_1">
                <div class="banner-container">
                    <!-- 创建图片存储容器 -->
                    <div class="banner-img-container">
                        <img src="./image/sign-wall.png" alt="">
                        <img src="./image/sign-wall.png" alt="">
                        <img src="./image/sign-wall.png" alt="">
                        <img src="./image/sign-wall.png" alt="">
                        <img src="./image/sign-wall.png" alt="">
                    </div>
                </div>
            </div>
            <div id="sign_name" contenteditable="true" onfocus="clearText()">签名栏</div>
            <!--按钮区域-->
            <div id="pg0_2"></div>
        </div>
        <div id="pg1" style="display: none">
            <div class="banner-container1">
                <!-- 这里利用input的checked状态来为a标签添加选中状态 -->
                <!-- 布局方式采用的是 input + a 标签，不可以添加父级，不然css无法选择到 banner-img-container -->
                <!-- 轮播图圆点 -->
                <input type="radio" name="radio-set" checked="checked" id="banner-control-1">
                <a class="banner-nav-a" href="#banner01"></a>
                <input type="radio" name="radio-set" id="banner-control-2">
                <a class="banner-nav-a" href="#banner02"></a>
                <input type="radio" name="radio-set" id="banner-control-3">
                <a class="banner-nav-a" href="#banner03"></a>
                <input type="radio" name="radio-set" id="banner-control-4">
                <a class="banner-nav-a" href="#banner04"></a>
                <input type="radio" name="radio-set" id="banner-control-5">
                <a class="banner-nav-a" href="#banner05"></a>
                <!-- 轮播图图片容器 -->
                <div class="banner-img-container">
                    <ul id="banner01">
                        <li>
                            <a href="#item-1" class="item"><img src="./image/item_01.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-2" class="item"><img src="./image/item_02.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-3" class="item"><img src="./image/item_03.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-4" class="item"><img src="./image/item_04.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <img id="targetimg" src="./image/item_06.png" class="item-nav-img" alt="" />
                        </li>
                        <li>
                            <a href="#item-7" class="item"><img src="./image/item_07.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-8" class="item"><img src="./image/item_08.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-9" class="item"><img src="./image/item_09.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-10" class="item"><img src="./image/item_10.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-11" class="item"><img src="./image/item_11.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                        <li>
                            <a href="#item-12" class="item"><img src="./image/item_12.png" class="item-nav-img"
                                    alt="" /></a>
                        </li>
                    </ul>
                    <ul id="banner02">

                        <li>
                            <img src="./image/item6.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                    </ul>

                    <ul id="banner03">

                        <li>
                            <img src="./image/item6.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item6.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                    </ul>
                    <ul id="banner04">

                        <li>
                            <img src="./image/item6.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                    </ul>
                    <ul id="banner05">

                        <li>
                            <img src="./image/item6.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item7.png" alt="" />
                        </li>
                        <li>
                            <img src="./image/item8.png" alt="" />
                        </li>
                    </ul>
                </div>
            </div>
            <!--下一页按钮-->
            <div id="pg1_2">
            </div>
        </div>
        <div id="pg2" style="display: none">
            <div id="pg2_ticket">
                <img src="./image/ticket.png" />
            </div>
            <!--按钮区域-->
            <div id="pg2_1">
            </div>
        </div>
        <div id="pg3" style="display: none">
            <div id="pg3_ticket">
                <img class="bg" src="./image/ticket_full.png" />
                <img id="idol" src="./image/idol1.png" />
                <div id="name">大帝</div>
                <div id="groupname">第五人格</div>
                <div id="seat"><span>09</span> 排<span>99</span> 座</div>
                <div id="neighbor">卡梅隆安东尼</div>
                <div id="slogan">你好世界</div>
            </div>

            <!--按钮区域-->
            <div id="pg3_1">
                <img src="./image/btn_pick.png" />
            </div>
        </div>
        <div id="pg4" style="display: none">
            <div id="pg4_container">
                <ul>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift1.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                    <li><img src="./image/gift0.png" /></li>
                </ul>
            </div>
            <!--按钮区域-->
            <div id="pg4_1">
            </div>
        </div>

        <div id="pg12" style="display: none">
            <div id="pg12_0" style="display: none;">
            </div>
            <div id="pg12_1" style="display: none; opacity: 0">
                <div id="pg12_1_1" style="display: none">
                    分享结果
                </div>
                <div id="pg12_1_2" style="display: none">
                    重来一次
                </div>
                <div id="pg12_1_5" style="display: none">
                    下载图片
                </div>
                <div id="pg12_1_3" style="display: none">
                </div>
                <div id="pg12_1_4" style="display: none">
                    <img src="images/qrcode.png" /><br />快来扫码测试
                </div>
            </div>
        </div>
        <div class="sound">
        </div>
        <div class="d-share">
            <img src="images/share.png" class="d-share-hint">
        </div>
        <div id="save" style="z-index:1600;">

        </div>
    </div>
    <div id="bmg" style="display: none;" class="sound">
    </div>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script type="text/javascript">
        //获取url中的参数
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            var r = window.location.search.substr(1).match(reg);  //匹配目标参数
            if (r != null) return unescape(r[2]); return null; //返回参数值
        }

        function clearText() {
            var text = $("#sign_name").text().replace("签名栏", "");
            $("#sign_name").text(text);
        }

        $("#bmg").bgmusic({ 'url': 'http://h5.vr.mgtv.com/2016/zmfm/img2/music.mp3', 'autoplay': true });
        var audio = document.querySelector('audio');
        var sharelink = "http://h5.vr.mgtv.com/2016/zmfm/star2.htm";
        $(document).ready(function () {
            var result = getUrlParam("result");

            console.log("ready:" + result);

            //audio.play();
            //$(".sound").css("display", "block");
            /*
            $("#splay").show();
            $("#sclose").hide();
            */
            $("#tbname1").click(function () {
                if ($("#tbname1").val() == "请输入名字") { $("#tbname1").val(""); }
            });
            $("#tbname2").click(function () {
                if ($("#tbname2").val() == "请输入名字") { $("#tbname2").val(""); }
            });
            //按钮跳转 P1跳P2
            $("#pg0_2").click(function () {
                var text = $("#sign_name").text();
                console.log(text);
                if (text == "" || text == "签名栏") {
                    alert("请填写签名哦！");
                    return;
                } else {
                    $("#pg1").css("display", "block");
                    $("#pg0").css("display", "none");
                }
            });
            //P2跳P3
            $("#pg1_2").click(function () {
                console.log("showquestion:");
                $("#pg2").css("display", "block");
                $("#pg1").css("display", "none");
                console.log("滑动");
                setTimeout(function () {
                    $("#pg2_ticket").find("img").addClass("move");
                }, 500);

            });
            //P3跳P4
            $("#pg2_1").click(function () {
                var text = $("#sign_name").text();
                console.log("同步签名栏的名字:");
                $("#name").text(text);
                $("#pg3").css("display", "block");
                $("#pg2").css("display", "none");
            });
            //P4跳P5
            $("#pg3_1").click(function () {
                $("#pg4").css("display", "block");
                $("#pg3").css("display", "none");
            });

            //切换图片
            $("#targetimg").click(function () {
                console.log("切换图片");
                $("#targetimg").attr("src", "./image/item_05.png");
            });


            var title = "丁磊邀请你参加520发布会",
                link = "http://h5.vr.mgtv.com/2016/zmfm/star2.htm",
                desc = "丁磊邀请你参加520发布会",
                img = "http://h5.vr.mgtv.com/2016/zmfm/img2/logo.jpg",
                api = "http://v.api.mgtv.com/weixin/sign";
            $.ajax({
                type: "get",
                async: false,
                url: "http://v.api.mgtv.com/weixin/sign?url=" + encodeURIComponent(location.href.split("#")[0]),
                dataType: "jsonp",
                jsonp: "callback", //传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(一般默认为:callback)
                jsonpCallback: "flightHandler", //自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名，也可以写"?"，jQuery会自动为你处理数据
                success: function (e) {
                    wx.config({
                        debug: !1,
                        appId: e.data.appId,
                        timestamp: e.data.timestamp,
                        nonceStr: e.data.nonceStr,
                        signature: e.data.signature,
                        jsApiList: ["onMenuShareTimeline", "onMenuShareAppMessage"]
                    }), wx.ready(function (e) {
                        wx.onMenuShareTimeline({
                            title: desc,
                            link: link,
                            imgUrl: img,
                            trigger: function (res) {
                                this.link = sharelink;
                            }
                        }), wx.onMenuShareAppMessage({
                            title: title,
                            desc: desc,
                            link: link,
                            imgUrl: img,
                            trigger: function (res) {
                                this.link = sharelink;
                            }
                        })
                    })
                },
                error: function () {
                    alert('fail');
                }
            });
        });

        function pageinit() {

        };


        $("#splay").click(function () {
            audio.pause();
            $("#splay").hide();
            $("#sclose").show();
        });

        $("#sclose").click(function () {
            audio.play();
            $("#splay").show();
            $("#sclose").hide();
        });
    </script>
</body>

</html>